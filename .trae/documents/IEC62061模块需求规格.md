# IEC 62061 模块需求规格（PFHd/SIL/T1/T10D）

## 1. 目标
- 在现有平台中新增 IEC 62061 计算与验证能力，支持对安全相关电/电子/可编程控制系统（SRECS）的 SIL 目标设定、PFHd 计算与子系统聚合，并输出标准化报告与合规映射。

## 2. 术语与范围
- SRECS、PFHd（每小时危险失效概率）、SIL（1..3）、T1（Proof Test Interval）、T10D（有用寿命/10%危险失效时间）。
- 与 ISO 13849-1 的关系：在电/电子/可编程系统中可选择 IEC 62061 方法；提供 PL↔SIL 对照与注意事项。

## 3. 数据模型
- SafetyFunction62061
  - id, name, description, targetSIL
  - subsystems[]: Subsystem
  - assumptions: missionTime(T10D), proofTestInterval(T1), environment, demandMode(on-demand/continuous)
  - evidenceRefs[]
- Subsystem
  - id, name, architecture (1oo1,1oo2,2oo3...)
  - components[]: Component
  - pfhdCalculated
- Component
  - id, manufacturer, model
  - parameters: pfhd, sff, hft, beta, lambdaD, mtbf, proofTestCoverage
  - certificates[]

## 4. 计算流程（概要）
1) 组件级 PFHd 计算/输入（支持直接给定或基于失效率参数推导）。
2) 子系统 PFHd 聚合（考虑架构、冗余与共因失效 β 因子）。
3) 系统级 PFHd 汇总与对照目标 SIL 区间；校核 T1/T10D 与证明试验覆盖率。
4) 输出：达成 SIL、PFHd 数值、关键假设、边界条件与不确定性说明。

## 5. 输入校核与提示
- 当 T1 > T10D：提示使用寿命超期风险与 PFHd 失真风险。
- 当证据缺失：要求上传证书/数据表或选择保守参数；记录证据占位。
- 当 β 因子偏大：提示冗余有效性下降与整改建议。

## 6. 与 ISO 13849-1 的映射
- 提供 PL↔SIL 对照区间，并说明不同方法下的边界与假设差异。
- 支持同一安全功能的双标准并行评估与合并报告。

## 7. API 设计（草案）
- POST /api/iec62061/evaluate
  - 入参：SafetyFunction62061
  - 出参：{ pfhd, achievedSIL, warnings[], details }
- POST /api/iec62061/report(.pdf)
  - 入参：evaluationId / payload
  - 出参：HTML/PDF 报告（双语，含计算明细与证据引用）
- GET/POST /api/iec62061/functions/{id}
  - 管理函数、子系统与组件；绑定证据与审计。

## 8. 前端交互（概要）
- 62061 评估页：目标 SIL 与参数录入、子系统/组件添加与架构选择、PFHd 实时计算与警告提示。
- 报告预览：明细与条款映射、证据引用与签名、导出 HTML/PDF。

## 9. 报告与合规映射
- 报告包含：
  - PFHd 计算链路与公式、关键参数与来源、假设与边界条件、T1/T10D 校核结果。
  - 达成 SIL 结论与不符合项整改建议。
- 合规映射矩阵：IEC 62061 条款 → 证据 → 结果。

## 10. 测试与示例
- 单元测试：组件→子系统→系统 PFHd 聚合与阈值校核；T1/T10D 规则与警告。
- 集成测试：典型 1oo2、2oo3 架构；β 因子敏感性分析；证据链完整性。
- 示例数据：SIL1/2/3 三类典型组合与边界场景。

## 11. 参考
- Siemens SET（IEC 62061 与 ISO 13849-1 覆盖）：https://www.siemens.com/us/en/products/automation/topic-areas/safety-integrated/factory-automation/support/safety-evaluation-tool.html
- Rockwell PFHd/寿命/证明试验间隔白皮书：https://literature.rockwellautomation.com/idc/groups/literature/documents/wp/safety-wp040_-en-p.pdf

